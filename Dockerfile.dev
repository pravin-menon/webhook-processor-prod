# Base image
FROM golang:1.24-alpine

# Set working directory
WORKDIR /app

# Install dependencies for live-reloading (air) and timezone data
RUN apk add --no-cache git tzdata && \
    go install github.com/cosmtrek/air@v1.44.0 && \
    cp /usr/share/zoneinfo/Asia/Kolkata /etc/localtime && \
    echo "Asia/Kolkata" > /etc/timezone

# Copy dependency manifests
COPY go.mod go.sum ./

# Download dependencies (without vendor)
RUN go mod download

# Copy the rest of the application source
COPY . .

# Ensure tmp directory exists
RUN mkdir -p ./tmp

# Command to run the application using Air for live reloading
CMD ["air", "-c", "air.toml"]
